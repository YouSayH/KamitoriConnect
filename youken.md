# 1. システム要件定義

バイブコーディングを円滑に進めるため、曖昧さを排除し、技術スタックを固定します。

### 1-1. プロジェクト概要
*   **目的:** 熊本市上通商栄会の活性化。インバウンド客（台湾・韓国・中国等）に対し、店舗の魅力を多言語で発信し、来店障壁（言語・情報）を取り除く。
*   **コア機能:**
    1.  **簡単投稿:** 店主が日本語で写真＋一言を入力するだけで、多言語（英・中・韓）に翻訳されSNSへ拡散される。
    2.  **AIコンシェルジュ:** 観光客がチャットで質問（場所、おすすめ、予約）すると、店舗情報を元にAIが回答する。

### 1-2. 技術スタック
*   **開発言語:** Python 3.10+
*   **フレームワーク:** FastAPI (非同期処理、高速API)
*   **データベース:**
    *   開発時: SQLite3 (ファイルベースで手軽)
    *   本番時: MySQL (AWS Lightsail等のマネージドまたはコンテナ)
    *   ORM: SQLAlchemy (Async対応)
*   **AI/LLM:** Google Gemini API (Gemini 1.5 Flash/Pro) - 画像認識と翻訳、チャットボットに使用。
*   **インフラ:** AWS Lightsail (コンテナサービス または OSインスタンス)。コストパフォーマンス重視。
*   **フロントエンド（想定）:** シンプルなHTML/JS、またはStreamlit/React（今回はAPIサーバー構築を主軸とします）。

### 1-3. 機能要件

#### A. 店舗側機能（管理者/店主向け）
1.  **店舗登録・管理:** 店舗名、ジャンル、基本情報（場所、営業時間）の登録。
2.  **投稿作成:**
    *   写真アップロード。
    *   日本語テキスト入力（短文）。
    *   **AI処理:** Geminiによる「魅力的な文章へのリライト」と「多言語翻訳（英・繁体字・簡体字・韓国語）」。
3.  **SNS連携（モック/API）:**
    *   作成された多言語コンテンツをInstagram/X等のAPIへ送信（初期開発では「送信したつもり」のログ出力またはDB保存でOK）。

#### B. 観光客側機能（ユーザー向け）
1.  **多言語AIコンシェルジュ（チャットボット）:**
    *   RAG（検索拡張生成）の仕組み。
    *   ユーザーの質問に対し、DB内の「店舗情報」や「過去の投稿」を検索し、Geminiが回答を生成。
    *   例：「あか牛丼が食べられるお店は？」「今開いているカフェは？」
2.  **クーポン・マップ表示:** チャットの流れでGoogleマップリンクやクーポン画像を表示。

### 1-4. データベース設計（主要エンティティ）
*   `Shops`: 店舗ID, 店舗名, 住所, ジャンル, 説明文
*   `Posts`: 投稿ID, 店舗ID, 原文(日), 画像URL, 日時
*   `Translations`: 翻訳ID, 投稿ID, 言語コード, 翻訳テキスト
*   `Coupons`: クーポンID, 店舗ID, 内容, 有効期限



### 今後の進め方のアドバイス

1.  **Phase 1 (骨組み):** 上記プロンプトを実行し、FastAPIが起動し、Swagger UI (`/docs`) でDB定義が見える状態にする。
2.  **Phase 2 (AI連携):** Gemini APIキーを取得し、投稿API (`POST /posts`) に「Geminiによる翻訳処理」を組み込む。
3.  **Phase 3 (チャット):** データが入った状態で、チャットAPI (`POST /chat`) を作り、DB検索結果をプロンプトに埋め込んで回答させる処理を書く。
4.  **Phase 4 (AWS):** AWS Lightsailでインスタンスを立て、Dockerまたは直接Python環境を作ってデプロイする。
